more functioms and neated loops
